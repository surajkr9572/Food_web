
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="payment.css">
    <title>Payment</title>
</head>
<body>
    <div class="form-container">
        <h2>Contact Us</h2>
        <form id="payment-form">
            <div class="form-group">
                <label for="name">Name</label>
                <input type="text" class="form-control" id="name" placeholder="Enter your name" required>
            </div>
            <div class="form-group">
                <label for="email">Email</label>
                <input type="email" class="form-control" id="email" placeholder="Enter your email" required>
            </div>
            <div class="form-group">
                <label for="contact">Contact Number</label>
                <input type="tel" class="form-control" id="contact" placeholder="Enter your contact number" required>
            </div>
            <div class="form-group">
                <label for="address">Address</label>
                <input type="text" class="form-control" id="address" placeholder="Enter your contact number" required>
            </div>
            <button type="submit" class="btn-submit" id="rzp-button1">Pay</button>
        </form>
    </div>
    
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
    fetch("/price")
      .then((response) => {
        return response.json();
      })
      .then((data) => {
        let price=data.fixprice;
        document.getElementById('payment-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;
            const contact = document.getElementById('contact').value;
            const address=document.getElementById('address').value;
            price=price*100;
            var options = {
                key: "rzp_test_ZzOMVkgPqEwsuR",
                amount: price,
                currency: "INR",
                name: "Payment mode",
                description: "for testing purpose",
                handler: async function (response) {
                    const paymentId = response.razorpay_payment_id;
                    try {
                       
                        const serverResponse = await axios.post("http://localhost:3000/payment", {
                            name: name,
                            email: email,
                            contact: contact,
                            address:address,
                            totalPrice: price / 100 
                            
                        });
                       
                        alert("Payment processed successfully!");
                        window.location.href = "home.html";
                    } catch (error) {
                        console.error("Error saving cart data:", error);
                        alert("Error processing payment.");
                    }
                },
                modal: {
                    ondismiss: function () {
                        console.log("Payment window dismissed.");
                    },
                },
                theme: {
                    color: "#07a291db",
                },
            };

            var pay = new window.Razorpay(options);
            pay.open();
        });
        });
    </script>
    
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>
